name: compile_latex_and_update_gh_pages

on:
  push:
    branches:
      - johannes

jobs:
  compile_and_deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout 'johannes' branch
        uses: actions/checkout@v4
        with:
          ref: 'johannes'

      - name: Compile LaTeX document
        uses: xu-cheng/latex-action@v2
        with:
          root_file: forallxbris.tex

      - name: Rename PDF and copy README for gh-pages
        run: |
          cp forallxbris.pdf forallxbris-js.pdf
          cp README.md index.md

      - name: Copy files to 'gh-pages' branch
        uses: planetoftheweb/copy-to-branches@v1
        env:
          key: johannes
          target: gh-pages
          files: forallxbris.pdf forallxbris-js.pdf index.md

      - name: Cleanup
        run: |
          rm forallxbris-js.pdf
          rm index.md
