name: compile_latex_and_update_gh_pages

on:
  push:
    branches:
      - johannes

jobs:
  compile_and_deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout 'johannes' branch to 'johannes-dir'
        uses: actions/checkout@v4
        with:
          ref: 'johannes'
          path: 'johannes-dir'

      - name: Compile LaTeX document in 'johannes-dir'
        run: |
          cd johannes-dir
          pdflatex -interaction=nonstopmode forallxbris.tex
          pdflatex -interaction=nonstopmode forallxbris.tex

      - name: Checkout 'gh-pages' branch to 'gh-pages-dir'
        uses: actions/checkout@v4
        with:
          ref: 'gh-pages'
          path: 'gh-pages-dir'

      - name: Copy files from 'johannes' to 'gh-pages' branch
        run: |
          cp johannes-dir/forallxbris.pdf gh-pages-dir/
          cp johannes-dir/forallxbris.pdf gh-pages-dir/forallxbris-js.pdf
          cp johannes-dir/README.md gh-pages-dir/index.md

      - name: Commit and push to 'gh-pages' branch
        run: |
          cd gh-pages-dir
          git config user.name "GitHub Action"
          git config user.email "action@github.com"
          git add forallxbris.pdf forallxbris-js.pdf index.md
          git commit -m "Update GitHub Pages with latest PDF and README"
          git push origin gh-pages
